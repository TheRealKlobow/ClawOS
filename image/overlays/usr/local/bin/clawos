#!/usr/bin/env bash
set -euo pipefail

cmd="${1:-help}"
shift || true

case "$cmd" in
  setup)
    exec sudo /usr/local/bin/clawos-setup-gateway.sh "$@"
    ;;
  status)
    exec /usr/local/bin/clawos-status.sh "$@"
    ;;
  update)
    exec sudo /usr/local/bin/clawos-update "$@"
    ;;
  doctor)
    exec /usr/local/bin/clawos-doctor.sh "$@"
    ;;
  fix-origin)
    exec sudo /usr/local/bin/clawos-fix-origin.sh "$@"
    ;;
  help|-h|--help)
    cat <<'EOF'
ClawOS helper command

Usage:
  clawos setup       Guided gateway setup (name/token/port/LAN)
  clawos status      Show gateway status + drift checks
  clawos update      Update ClawOS runtime from latest release
  clawos doctor      Normalize config/service mode and fix common drift
  clawos fix-origin  Apply allowed origins for current IP/port
EOF
    ;;
  *)
    echo "Unknown command: $cmd" >&2
    echo "Try: clawos help" >&2
    exit 1
    ;;
esac
